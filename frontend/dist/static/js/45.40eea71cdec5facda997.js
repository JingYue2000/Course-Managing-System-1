webpackJsonp([45],{VOPJ:function(e,t){},Xbe9:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=a("Xxa5"),r=a.n(l),o=a("exGp"),s=a.n(o),n={name:"ProjectCreate",data:function(){return{addDialogVisible:!1,formData:{projectName:"",projectType:"",startTime:"",endTime:"",projectDesc:"",managerName:"",teacherName:""},memberList:[],newMemberInfo:{name:"",class:"",sno:"",position:""},resource:"",createdPid:"",positionOptions:[{value:"项目经理",label:"项目经理"},{value:"系统设计师",label:"系统设计师"},{value:"系统分析师",label:"系统分析师"},{value:"前端工程师",label:"前端工程师"},{value:"后端工程师",label:"后端工程师"},{value:"测试工程师",label:"测试工程师"},{value:"文档管理员",label:"文档管理员"},{value:"数据库管理员",label:"数据库管理员"}],classList:[],selectorInfo:[],studentInProject:[]}},mounted:function(){var e=this;this.$get("project/all_class").then(function(t){e.classList=t.data.data,e.classList=e.classList.reverse()}),this.$get("project/all_stu").then(function(t){e.selectorInfo=t.data.data}),this.$get("project/all_member_info").then(function(t){e.studentInProject=t.data.data})},methods:{removeUserBySno:function(e){for(var t=0;t<this.memberList.length;t++)this.memberList[t].sno===e&&this.memberList.splice(t,1)},addDialogClosed:function(){this.newMemberInfo={name:"",class:"",sno:"",position:""}},addMemberCommit:function(e){for(var t=!1,a=0;a<this.studentInProject.length;a++)this.studentInProject[a].sid==e.sno&&(t=!0);t?this.$message.error("该学生已加入一个项目，请勿重复添加！"):(this.memberInfo.push(e),this.$message.success("添加新成员成功！")),this.addDialogVisible=!1},resetForm:function(e){this.formData={projectName:"",projectType:"",startTime:"",endTime:"",projectDesc:"",managerName:"",teacherName:""},this.memberList=[],this.resource=""},onSubmit:function(){var e=this;this.submitProjectInfo().then(function(){return e.submitProjectDetails()})},submitProjectInfo:function(){var e=this;return s()(r.a.mark(function t(){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$post("/project",e.formData).then(function(t){e.createdPid=t.data.data.pid,e.$message.success("项目基本信息添加成功！")}).catch(function(t){e.$message.error("项目基本信息添加失败！")});case 2:case"end":return t.stop()}},t,e)}))()},submitProjectDetails:function(){for(var e=this,t=[],a=0;a<this.memberList.length;a++)t[a]={},t[a].sid=this.memberList[a].sno,t[a].position=this.memberList[a].position;var l={pid:this.createdPid,member:t};this.$post("/project/member_info",l).then(function(t){e.$message.success("项目成员信息添加成功！")})}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{width:"100%","padding-left":"100px","padding-right":"100px"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"grid-content bg-purple-light header",staticStyle:{"margin-bottom":"40px"}},[a("dv-decoration-7",[e._v("创建项目")])],1)])],1),e._v(" "),a("el-form",{ref:"projectForm",attrs:{model:e.formData,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"项目名称"}},[a("el-input",{attrs:{placeholder:"填写项目名称"},model:{value:e.formData.projectName,callback:function(t){e.$set(e.formData,"projectName",t)},expression:"formData.projectName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"负责人"}},[a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"项目经理姓名"},model:{value:e.formData.managerName,callback:function(t){e.$set(e.formData,"managerName",t)},expression:"formData.managerName"}})],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-input",{attrs:{placeholder:"指导老师姓名"},model:{value:e.formData.teacherName,callback:function(t){e.$set(e.formData,"teacherName",t)},expression:"formData.teacherName"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"项目类型"}},[a("el-select",{attrs:{"allow-create":"",filterable:"",clearable:"",placeholder:"项目类型,可键入其他类型"},model:{value:e.formData.projectType,callback:function(t){e.$set(e.formData,"projectType",t)},expression:"formData.projectType"}},[a("el-option",{attrs:{label:"web应用开发",value:"web"}}),e._v(" "),a("el-option",{attrs:{label:"桌面应用开发",value:"desktop"}}),e._v(" "),a("el-option",{attrs:{label:"微信小程序开发",value:"wechat"}}),e._v(" "),a("el-option",{attrs:{label:"AI算法应用",value:"ai"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"项目时间"}},[a("el-col",{attrs:{span:12}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"开始时间",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd"},model:{value:e.formData.startTime,callback:function(t){e.$set(e.formData,"startTime",t)},expression:"formData.startTime"}})],1),e._v(" "),a("el-col",{staticClass:"line",attrs:{span:2}},[a("span")]),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date",placeholder:"结束时间",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd"},model:{value:e.formData.endTime,callback:function(t){e.$set(e.formData,"endTime",t)},expression:"formData.endTime"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"特殊资源"}},[a("el-radio-group",{model:{value:e.resource,callback:function(t){e.resource=t},expression:"resource"}},[a("el-radio",{attrs:{label:"服务器设备"}}),e._v(" "),a("el-radio",{attrs:{label:"人力资源支持"}}),e._v(" "),a("el-radio",{attrs:{label:"其他资源"}}),e._v(" "),a("el-radio",{attrs:{label:"无需"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"项目描述"}},[a("el-input",{attrs:{type:"textarea",placeholder:"介绍一下你的项目吧"},model:{value:e.formData.projectDesc,callback:function(t){e.$set(e.formData,"projectDesc",t)},expression:"formData.projectDesc"}})],1),e._v(" "),a("el-form-item",[a("div",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("添加新成员")])],1)],1),e._v(" "),a("el-row",[a("el-table",{attrs:{data:e.memberList,border:"",stripe:""}},[a("el-table-column",{attrs:{label:"姓名",prop:"name",width:"100px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"班级",prop:"class",width:"100px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"学号",prop:"sno",width:"150px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"岗位",prop:"position",width:"150px",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"70px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(a){return e.removeUserBySno(t.row.sno)}}})]}}])})],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"添加新成员",visible:e.addDialogVisible,width:"30%"},on:{"update:visible":function(t){e.addDialogVisible=t},close:e.addDialogClosed}},[a("el-form",{ref:"addFormRef",attrs:{model:e.newMemberInfo,"label-width":"70px"}},[a("el-form-item",{attrs:{label:"班级",prop:"class"}},[a("el-select",{attrs:{placeholder:"选择成员所在班级",clearable:"",size:"medium"},model:{value:e.newMemberInfo.class,callback:function(t){e.$set(e.newMemberInfo,"class",t)},expression:"newMemberInfo.class"}},e._l(e.classList,function(e){return a("el-option",{key:e.class,attrs:{label:e.class,value:e.class}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-select",{attrs:{placeholder:"选择成员姓名",clearable:"",size:"medium"},model:{value:e.newMemberInfo.name,callback:function(t){e.$set(e.newMemberInfo,"name",t)},expression:"newMemberInfo.name"}},e._l(e.selectorInfo,function(t){return e.newMemberInfo.class==t.class?a("el-option",{key:t.name,attrs:{label:t.name,value:t.name}}):e._e()}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"学号",prop:"sno"}},[a("el-select",{attrs:{placeholder:"成员学号",clearable:"",size:"medium"},model:{value:e.newMemberInfo.sno,callback:function(t){e.$set(e.newMemberInfo,"sno",t)},expression:"newMemberInfo.sno"}},e._l(e.selectorInfo,function(t){return e.newMemberInfo.name==t.name?a("el-option",{key:t.sid,attrs:{label:t.sid,value:t.sid}}):e._e()}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"角色",prop:"position"}},[a("el-select",{attrs:{placeholder:"可通过输入创建新选项","allow-create":"",filterable:"",clearable:"",size:"medium"},model:{value:e.newMemberInfo.position,callback:function(t){e.$set(e.newMemberInfo,"position",t)},expression:"newMemberInfo.position"}},e._l(e.positionOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.addMemberCommit(e.newMemberInfo)}}},[e._v("确 定")])],1)],1)],1)]),e._v(" "),a("el-form-item",[a("el-col",{attrs:{span:10}},[a("el-popover",{attrs:{placement:"top-start",title:"温馨提示",width:"200",trigger:"hover",content:"点击按钮后即可完成项目创建。"}},[a("el-button",{attrs:{slot:"reference",type:"success"},on:{click:e.onSubmit},slot:"reference"},[e._v("立即创建")])],1)],1),e._v(" "),a("el-col",{attrs:{span:4}},[e._v(" ")]),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-popover",{attrs:{placement:"top-start",title:"请注意",width:"200",trigger:"hover",content:"请注意，点击按钮后将清空表单已填内容。"}},[a("el-button",{attrs:{slot:"reference",type:"danger"},on:{click:function(t){return e.resetForm("projectForm")}},slot:"reference"},[e._v("重置表单")])],1)],1)],1)],1)],1)},staticRenderFns:[]},c=a("VU/8")(n,i,!1,function(e){a("VOPJ")},null,null);t.default=c.exports}});