webpackJsonp([40],{qxSt:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("mtWM"),s=a.n(r),i={data:function(){return{loading:!0,seven:{series:[],chartOptions:{chart:{shadow:{enabled:!0,color:"#000",top:18,left:7,blur:10,opacity:1},toolbar:{show:!1}},colors:["#f5564e","#35d0ba"],dataLabels:{enabled:!0},stroke:{curve:"smooth"},markers:{size:4},xaxis:{},yaxis:{}}},future:{series:[],chartOptions:{chart:{toolbar:{show:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth"},xaxis:{}}},dataSource:[],storage:[],citys:[],areaId:"",htmlspan:'<span style="display:inline-block;margin-right: 5px;border-radius: 10px;width: 10px;height: 10px;background-color: ',servenChart:{},futureChart:{},legends:["最高温","最低温"],weather:{provinceName:"",countyName:"",weathers:[],day_c:[],night_c:[],hours_c:[],dateArr:[],timeArr:[],publishTime:"",alarms:[],realtime:{},indexes:[]}}},mounted:function(){var e=this;this.servenChart=this.$echarts.init(document.getElementById("servenChart")),this.futureChart=this.$echarts.init(document.getElementById("futureChart")),s.a.get("../../../static/file/city.json").then(function(t){e.citys=t.data})},methods:{handleSearch:function(e){if(this.dataSource=[],this.storage=[],this.areaId="",e)for(var t=0;t<this.citys.length;t++){var a=this.citys[t];-1!==a.countyname.indexOf(e)&&(this.dataSource.push(a.countyname),this.storage.push(a.areaid))}},onSelect:function(e){var t=this.dataSource.indexOf(e);this.areaId=this.storage[t]},searchWeather:function(){var e=this,t=this;this.areaId?this.$get("weather?areaId="+this.areaId).then(function(a){var r=JSON.parse(a.data.data);if("200"===r.code){e.weather={countyName:"",weathers:[],day_c:[],night_c:[],hours_c:[],dateArr:[],timeArr:[],publishTime:""},e.loading=!1,e.weather.provinceName=r.value[0].provinceName,e.weather.countyName=r.value[0].city,e.weather.weathers=r.value[0].weathers,e.weather.alarms=r.value[0].alarms,e.weather.realtime=r.value[0].realtime,e.weather.indexes=r.value[0].indexes;for(var s=e.weather.weathers,i=0,n=0,h=0;h<s.length;h++){var o=parseFloat(s[h].temp_day_c),l=parseFloat(s[h].temp_night_c);h===s.length-1?(e.weather.day_c.unshift(o),e.weather.night_c.unshift(l),e.weather.dateArr.unshift(s[h].date.split("-")[1]+"-"+s[h].date.split("-")[2])):(e.weather.day_c.push(o),e.weather.night_c.push(l),e.weather.dateArr.push(s[h].date.split("-")[1]+"-"+s[h].date.split("-")[2])),0===h?(n=o,i=l):(o>n&&(n=o),l<i&&(i=l))}var c=r.value[0].weatherDetailsInfo.weather3HoursDetailsInfos;e.weather.publishTime=r.value[0].weatherDetailsInfo.publishTime;for(var p=0;p<c.length;p++){var d=c[p].endTime.split(" ")[1].split(":");e.weather.hours_c.push(parseFloat(c[p].highestTemperature)),e.weather.timeArr.push(d[0]+":"+d[1])}var u=[];u.push({name:"最高温",type:"line",data:e.weather.day_c}),u.push({name:"最低温",type:"line",data:e.weather.night_c}),e.servenChart.setOption({title:{text:e.weather.provinceName+" - "+e.weather.countyName+"未来七日气温",show:!0,left:10,top:10},tooltip:{trigger:"axis",axisPointer:{type:"line"},formatter:function(e){for(var a="",r=0;r<e.length;r++)0===r&&(a+=e[r].axisValue+"<br />"),r===e.length-1?a+=t.htmlspan+e[r].color+';"></span>'+e[r].seriesName+" : "+e[r].value:a+=t.htmlspan+e[r].color+';"></span>'+e[r].seriesName+" : "+e[r].value+"<br />";return a}},legend:{type:"scroll",x:"center",y:"bottom",textStyle:{fontSize:"12"},data:e.legends},toolbox:{show:!0,right:20,top:10,feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!0,data:e.weather.dateArr,axisLabel:{textStyle:{fontSize:"12"}}},yAxis:{type:"value",axisLabel:{formatter:"{value}",textStyle:{fontSize:"12"}},min:i-5,max:n+5},grid:{left:"4%"},series:u},!0),e.futureChart.setOption({title:{text:e.weather.provinceName+" - "+e.weather.countyName+"未来气温细节",show:!0,left:10,top:10},tooltip:{trigger:"axis",axisPointer:{type:"line"},formatter:function(e){for(var a="",r=0;r<e.length;r++)0===r&&(a+=e[r].axisValue+"<br />"),r===e.length-1?a+=t.htmlspan+e[r].color+';"></span>'+e[r].seriesName+" : "+e[r].value:a+=t.htmlspan+e[r].color+';"></span>'+e[r].seriesName+" : "+e[r].value+"<br />";return a}},legend:{show:!1},toolbox:{show:!0,right:20,top:10,feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!0,data:e.weather.timeArr,axisLabel:{textStyle:{fontSize:"12"}}},yAxis:{type:"value",axisLabel:{formatter:"{value}",textStyle:{fontSize:"12"}}},grid:{left:"4%"},series:{name:"未来气温",type:"line",data:e.weather.hours_c}},!0)}}).catch(function(t){e.$message.error("天气查询失败")}):this.$message.warning("请选择城市")}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{width:"100%",padding:"0 1rem"}},[a("div",{staticClass:"global-search-main"},[a("div",{staticClass:"global-search-wrapper"},[a("a-auto-complete",{staticClass:"global-search",attrs:{dataSource:e.dataSource,placeholder:"请输入城市名"},on:{select:e.onSelect,search:e.handleSearch}},[a("a-input",[a("a-button",{staticClass:"search-btn",attrs:{slot:"suffix",type:"primary"},on:{click:function(t){return t.stopPropagation(),e.searchWeather(t)}},slot:"suffix"},[a("a-icon",{attrs:{type:"search"}})],1)],1)],1)],1)]),e._v(" "),a("div",{staticClass:"weather-area"},[a("div",{staticClass:"weather-info"},[a("a-row",{attrs:{gutter:8}},[a("a-col",{attrs:{span:12}},[a("div",{staticStyle:{height:"400px",border:"1px solid  #f1f1f1","border-radius":"5px"},attrs:{id:"servenChart"}})]),e._v(" "),a("a-col",{attrs:{span:12}},[a("div",{staticStyle:{height:"400px",border:"1px solid  #f1f1f1","border-radius":"5px"},attrs:{id:"futureChart"}})])],1)],1)]),e._v(" "),a("div",{staticClass:"weather-area"},[a("div",{staticClass:"weather-info"},[a("a-card",{attrs:{loading:e.loading,title:this.weather.countyName+" 当前天气"}},[a("a-row",[a("a-col",{attrs:{span:8}},[a("p",[e._v("天气："+e._s(this.weather.realtime.weather))])]),e._v(" "),a("a-col",{attrs:{span:8}},[a("p",[e._v("风向："+e._s(this.weather.realtime.wD))])]),e._v(" "),a("a-col",{attrs:{span:8}},[a("p",[e._v("风力大小："+e._s(this.weather.realtime.wS))])])],1),e._v(" "),a("a-row",[a("a-col",{attrs:{span:8}},[a("p",[e._v("温度："+e._s(this.weather.realtime.temp)+"℃")])]),e._v(" "),a("a-col",{attrs:{span:8}},[a("p",[e._v("体感温度："+e._s(this.weather.realtime.sendibleTemp)+"℃")])]),e._v(" "),a("a-col",{attrs:{span:8}},[a("p",[e._v("空气湿度："+e._s(this.weather.realtime.sD)+"%")])])],1),e._v(" "),a("a-row",[a("a-col",{attrs:{span:8}},[a("p",[e._v("更新时间："+e._s(this.weather.realtime.time))])])],1)],1)],1),e._v(" "),a("div",{staticClass:"weather-info"},[a("a-card",{attrs:{loading:e.loading,title:this.weather.countyName+" 未来天气"}},[a("a-row",e._l(this.weather.weathers,function(t,r){return a("a-col",{key:r,attrs:{span:24}},[6!==r?[a("p",[e._v(e._s(t.date)+"【"+e._s(t.week)+"】：日出时间 --- "+e._s(t.sun_rise_time)+"      日落时间 --- "+e._s(t.sun_down_time)+"      天气 --- "+e._s(t.weather))])]:e._e()],2)}),1)],1)],1),e._v(" "),a("div",{staticClass:"weather-info"},[a("a-card",{attrs:{loading:e.loading,title:this.weather.countyName+" 生活指数"}},[a("a-row",e._l(this.weather.indexes,function(t,r){return a("a-col",{key:r,attrs:{span:24}},[a("p",[e._v(e._s(t.name)+" --- "+e._s(t.content))])])}),1)],1)],1),e._v(" "),this.weather.alarms.length?a("div",{staticClass:"weather-info"},[a("a-card",{attrs:{loading:e.loading,title:this.weather.countyName+" 预警信息"}},[a("a-col",{attrs:{span:24}},[a("p",[e._v("预警标题 --- "+e._s(this.weather.alarms[0].alarmDesc))]),e._v(" "),a("p",[e._v("预警类型 --- "+e._s(this.weather.alarms[0].alarmTypeDesc))]),e._v(" "),a("p",[e._v("预警等级 --- "+e._s(this.weather.alarms[0].alarmLevelNoDesc))]),e._v(" "),a("p",[e._v("发布时间 --- "+e._s(this.weather.alarms[0].publishTime))]),e._v(" "),a("p",[e._v("预防措施 --- "+e._s(this.weather.alarms[0].precaution))]),e._v(" "),a("a-popover",{attrs:{title:"预警详情"}},[a("template",{slot:"content"},[a("div",{staticStyle:{"max-width":"360px"}},[e._v(e._s(this.weather.alarms[0].alarmContent))])]),e._v(" "),a("p",[e._v("预警详情 --- "+e._s(this.weather.alarms[0].alarmContent))])],2)],1)],1)],1):e._e()])])},staticRenderFns:[]},h=a("VU/8")(i,n,!1,function(e){a("yb1M")},null,null);t.default=h.exports},yb1M:function(e,t){}});