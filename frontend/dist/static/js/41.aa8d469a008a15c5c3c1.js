webpackJsonp([41],{C8Fb:function(e,t){},mzHY:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("el-divider",{attrs:{"content-position":"center"}}),e._v(" "),s("el-header",{attrs:{id:"setRuleHeader",height:"34px"}},[s("dv-decoration-7",[e._v("设置打分规则")])],1),e._v(" "),s("div",{staticStyle:{margin:"30px 0 0 0"}},[s("el-main",{attrs:{id:"setRuleMain"}},[s("el-form",{staticClass:"demo-form-inline",attrs:{"label-width":"15%","label-position":"left"}},[s("el-form-item",{attrs:{label:"过程考核"}},[s("el-col",{attrs:{span:22}},[s("el-slider",{attrs:{step:5,"show-stops":"","show-input":"","input-size":"mini"},model:{value:e.markRule.process,callback:function(t){e.$set(e.markRule,"process",t)},expression:"markRule.process"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"文档及报告"}},[s("el-col",{attrs:{span:22}},[s("el-slider",{attrs:{step:5,"show-stops":"","show-input":"","input-size":"mini"},model:{value:e.markRule.docs,callback:function(t){e.$set(e.markRule,"docs",t)},expression:"markRule.docs"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"完成情况"}},[s("el-col",{attrs:{span:22}},[s("el-slider",{attrs:{step:5,"show-stops":"","show-input":"","input-size":"mini"},model:{value:e.markRule.completion,callback:function(t){e.$set(e.markRule,"completion",t)},expression:"markRule.completion"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"答辩表现"}},[s("el-col",{attrs:{span:22}},[s("el-slider",{attrs:{step:5,"show-stops":"","show-input":"","input-size":"mini"},model:{value:e.markRule.presentation,callback:function(t){e.$set(e.markRule,"presentation",t)},expression:"markRule.presentation"}})],1)],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary",size:"medium "},on:{click:e.setMarkRule}},[e._v("完成打分规则设置")])],1)],1)],1)],1),e._v(" "),s("el-divider",{attrs:{"content-position":"center"}}),e._v(" "),s("el-header",{attrs:{id:"selectStuHeader",height:"34px"}},[s("dv-decoration-7",[e._v("选择打分对象")])],1),e._v(" "),s("el-main",{attrs:{id:"selectStuMain"}},[s("el-select",{attrs:{placeholder:"选择项目",clearable:"",size:"medium"},model:{value:e.markingObj.pid,callback:function(t){e.$set(e.markingObj,"pid",t)},expression:"markingObj.pid"}},e._l(e.projectOptions,function(e){return s("el-option",{key:e.pid,attrs:{label:e.projectName,value:e.pid}})}),1),e._v(" "),s("el-select",{attrs:{placeholder:"选择成员姓名",clearable:"",size:"medium"},model:{value:e.markingObj.sid,callback:function(t){e.$set(e.markingObj,"sid",t)},expression:"markingObj.sid"}},e._l(e.studentOptions,function(t){return e.markingObj.pid==t.pid?s("el-option",{key:t.sid,attrs:{label:t.tuserInfo.name,value:t.sid}}):e._e()}),1)],1),e._v(" "),s("el-divider",{attrs:{"content-position":"center"}}),e._v(" "),s("el-header",{attrs:{id:"markHeader",height:"34px"}},[s("dv-decoration-7",[e._v("开始打分")])],1),e._v(" "),s("el-main",{attrs:{id:"markMain"}},[s("el-form",{staticClass:"demo-form-inline",attrs:{"label-width":"15%","label-position":"left"}},[s("el-form-item",{attrs:{label:"过程考核"}},[s("el-col",{attrs:{span:22}},[s("el-slider",{attrs:{"show-input":"","input-size":"mini"},on:{change:e.onGiveSubScore},model:{value:e.markResult.processScore,callback:function(t){e.$set(e.markResult,"processScore",t)},expression:"markResult.processScore"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"文档及报告"}},[s("el-col",{attrs:{span:22}},[s("el-slider",{attrs:{"show-input":"","input-size":"mini"},on:{change:e.onGiveSubScore},model:{value:e.markResult.docsScore,callback:function(t){e.$set(e.markResult,"docsScore",t)},expression:"markResult.docsScore"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"完成情况"}},[s("el-col",{attrs:{span:22}},[s("el-slider",{attrs:{"show-input":"","input-size":"mini"},on:{change:e.onGiveSubScore},model:{value:e.markResult.completionScore,callback:function(t){e.$set(e.markResult,"completionScore",t)},expression:"markResult.completionScore"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"答辩表现"}},[s("el-col",{attrs:{span:22}},[s("el-slider",{attrs:{"show-input":"","input-size":"mini"},on:{change:e.onGiveSubScore},model:{value:e.markResult.presentationScore,callback:function(t){e.$set(e.markResult,"presentationScore",t)},expression:"markResult.presentationScore"}})],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"加权总分"}},[s("el-col",{attrs:{span:22}},[s("a-progress",{attrs:{"stroke-color":{from:"#03aeff",to:"#87d068"},percent:e.markResult.totalScore,format:function(e){return e+" 分"},status:"active"}})],1)],1)],1)],1),e._v(" "),s("el-divider",{attrs:{"content-position":"center"}}),e._v(" "),s("el-header",{attrs:{id:"commentHeader",height:"34px"}},[s("dv-decoration-7",[e._v("点评及反馈")])],1),e._v(" "),s("el-main",{attrs:{id:"commentMain"}},[s("el-input",{attrs:{type:"textarea",rows:"5",placeholder:"请在此对学生进行点评及反馈"},model:{value:e.markResult.feedback,callback:function(t){e.$set(e.markResult,"feedback",t)},expression:"markResult.feedback"}})],1),e._v(" "),s("el-main",{staticStyle:{"{align-content":"center"}},[s("el-form",[s("el-form-item",[s("el-col",{attrs:{span:3}},[e._v(" ")]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-popover",{attrs:{placement:"top-start",title:"温馨提示",width:"200",trigger:"hover",content:"点击按钮后即可提交对当前同学的打分结果。"}},[s("el-button",{attrs:{slot:"reference",type:"primary"},on:{click:e.onSubmitScore},slot:"reference"},[e._v("提交本次评价")])],1)],1),e._v(" "),s("el-col",{attrs:{span:1}},[e._v(" ")]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-popover",{attrs:{placement:"top-start",title:"请注意",width:"200",trigger:"hover",content:"请注意，点击按钮后将发布全班成绩，请先确保已完成所有学生的评价。"}},[s("el-button",{attrs:{slot:"reference",type:"success"},on:{click:e.onReleaseScore},slot:"reference"},[e._v("发布全班成绩")])],1)],1),e._v(" "),s("el-col",{attrs:{span:1}},[e._v(" ")]),e._v(" "),s("el-col",{attrs:{span:6}},[s("el-popover",{attrs:{placement:"top-start",title:"温馨提示",width:"200",trigger:"hover",content:"点击按钮后将取消已发布发的成绩，原来的评分记录仍然存在，但学生无法查看。"}},[s("el-button",{attrs:{slot:"reference",type:"warning"},on:{click:e.onUnReleaseScore},slot:"reference"},[e._v("暂停成绩发布")])],1)],1)],1)],1)],1)],1)},staticRenderFns:[]},o=s("VU/8")({name:"GiveScore",data:function(){return{markRule:{process:"",docs:"",completion:"",presentation:""},markResult:{sid:"",totalScore:"",processScore:"",docsScore:"",completionScore:"",presentationScore:"",feedback:"",isReleased:"0"},customColors:[{color:"#f56c6c",percentage:60},{color:"#e6a23c",percentage:90},{color:"#5cb87a",percentage:100}],hasSetRule:!1,projectOptions:[{pid:"",projectName:""}],studentOptions:[{pid:"",sid:"",tuserInfo:{name:""}}],markingObj:{pid:"",sid:""}}},mounted:function(){var e=this;this.$get("project/score/rules").then(function(t){e.markRule.process=t.data.data[0].ratio,e.markRule.docs=t.data.data[1].ratio,e.markRule.completion=t.data.data[2].ratio,e.markRule.presentation=t.data.data[3].ratio}),this.$get("project/all").then(function(t){e.projectOptions=t.data.data}).catch(),this.$get("project/all_member_info").then(function(t){e.studentOptions=t.data.data})},methods:{setMarkRule:function(){var e=this;if(100===this.markRule.process+this.markRule.docs+this.markRule.completion+this.markRule.presentation){this.hasSetRule=!0;var t=this.markRule;this.$post("project/score/rules",t).then(function(t){e.$message.success("打分规则设置成功！")}).catch(function(t){e.$message.error("打分规则设置失败！")})}else this.$message.error("请确保所有选项之和为100！")},onGiveSubScore:function(){100===this.markRule.process+this.markRule.docs+this.markRule.completion+this.markRule.presentation?(this.markResult.totalScore=this.markResult.processScore*this.markRule.process+this.markResult.presentationScore*this.markRule.presentation+this.markResult.docsScore*this.markRule.docs+this.markResult.completionScore*this.markRule.completion,this.markResult.totalScore/=100):this.$message.error("请先完成打分规则设置！")},onSubmitScore:function(){var e=this;this.markResult.sid=this.markingObj.sid;var t={};t.completionScore=this.markResult.completionScore,t.docsScore=this.markResult.docsScore,t.processScore=this.markResult.processScore,t.presentationScore=this.markResult.presentationScore,t.totalScore=this.markResult.totalScore,t.feedback=this.markResult.feedback,t.isReleased=this.markResult.isReleased,t.sid=this.markResult.sid,t.tuserInfo={},t.tuserInfo.sid=this.markResult.sid,this.$post("project/score",t).then(function(t){e.$message.success("打分提交成功！")})},onReleaseScore:function(){var e=this;this.$put("project/release_score").then(function(t){e.$message.success("成绩已发布！")})},onUnReleaseScore:function(){var e=this;this.$put("project/unrelease_score").then(function(t){e.$message.info("成绩已暂停发布！")})}}},r,!1,function(e){s("C8Fb")},"data-v-233d5756",null);t.default=o.exports}});